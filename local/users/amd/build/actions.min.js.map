{"version":3,"file":"actions.min.js","sources":["../src/actions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/ \r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\nimport ModalFactory from 'core/modal_factory';\r\nimport ModalEvents from 'core/modal_events';\r\nimport Ajax from 'core/ajax';\r\nimport {get_string as getString} from 'core/str';\r\n\r\nconst Selectors = {\r\n    actions: {\r\n        deleteuser: '[data-action=\"deleteuser\"]',\r\n    },\r\n};\r\n\r\nexport const init = () => {\r\n    document.addEventListener('click', function(e) {\r\n        // e.stopImmediatePropagation();\r\n        let element = e.target.closest(Selectors.actions.deleteuser);\r\n        if (element) {\r\n            const id = element.getAttribute('data-id');\r\n            ModalFactory.create({\r\n                title: getString('deleteuser', 'local_users'),\r\n                type: ModalFactory.types.SAVE_CANCEL,\r\n                body: getString('deleteconfirm', 'local_users')\r\n            }).done(function(modal) {\r\n                this.modal = modal;\r\n                modal.setSaveButtonText(getString('delete', 'local_users'));\r\n                modal.getRoot().on(ModalEvents.save, function(e) {\r\n                    e.preventDefault();\r\n                    var params = {};\r\n                    params.id = id;\r\n                    var promise = Ajax.call([{\r\n                        methodname: 'local_users_deleteuser',\r\n                        args: params\r\n                    }]);\r\n                    promise[0].done(function(resp) {\r\n                        window.location = M.cfg.wwwroot + '/local/users/index.php';\r\n                    }).fail(function() {\r\n                        // do something with the exception\r\n                         console.log('exception');\r\n                    });\r\n                }.bind(this));\r\n                modal.show();\r\n            }.bind(this));\r\n        }\r\n    });\r\n};\r\n\r\n"],"names":["Selectors","deleteuser","document","addEventListener","e","element","target","closest","id","getAttribute","create","title","type","ModalFactory","types","SAVE_CANCEL","body","done","modal","setSaveButtonText","getRoot","on","ModalEvents","save","preventDefault","params","Ajax","call","methodname","args","resp","window","location","M","cfg","wwwroot","fail","console","log","bind","this","show"],"mappings":"wdAoBMA,kBACO,CACLC,WAAY,4CAIA,KAChBC,SAASC,iBAAiB,SAAS,SAASC,OAEpCC,QAAUD,EAAEE,OAAOC,QAAQP,kBAAkBC,eAC7CI,QAAS,OACHG,GAAKH,QAAQI,aAAa,kCACnBC,OAAO,CAChBC,OAAO,mBAAU,aAAc,eAC/BC,KAAMC,uBAAaC,MAAMC,YACzBC,MAAM,mBAAU,gBAAiB,iBAClCC,KAAK,SAASC,YACRA,MAAQA,MACbA,MAAMC,mBAAkB,mBAAU,SAAU,gBAC5CD,MAAME,UAAUC,GAAGC,sBAAYC,KAAM,SAASnB,GAC1CA,EAAEoB,qBACEC,OAAS,GACbA,OAAOjB,GAAKA,GACEkB,cAAKC,KAAK,CAAC,CACrBC,WAAY,yBACZC,KAAMJ,UAEF,GAAGR,MAAK,SAASa,MACrBC,OAAOC,SAAWC,EAAEC,IAAIC,QAAU,4BACnCC,MAAK,WAEHC,QAAQC,IAAI,iBAEnBC,KAAKC,OACPtB,MAAMuB,QACRF,KAAKC"}